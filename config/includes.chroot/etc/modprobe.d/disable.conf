# Hardened by Dimensional Rift
# --------------------------------
#
# Description:
# This file is part of Dimensional Rift's security hardening measures.
# Here, listed kernel modules are disabled to improve system security and 
# reduce attack surface.
#
# Benefits:
# 1. Reduces attack surface: Each disabled module removes a potential code 
#    that attackers can exploit
# 2. Prevents data leaks: GPS, Firewire etc. hardware-based location and data 
#    leaks are prevented
# 3. Prevents privilege escalation attacks: Specifically defends against attacks 
#    caused by driver flaws
# 4. Prevents side-channel attacks: Thunderbolt etc. high bandwidth interfaces 
#    are prevented from being misused
# 5. Improves network security: Older and insecure network protocols are disabled
# 6. Flight mode hardening: All unused wireless technologies are disabled
#
# Each module is redirected to "/bin/false" with the "install" directive
# to prevent loading. This ensures the module is completely disabled.

# === Firewire Modules (Preventing Physical Memory Attacks) ===
install dv1394 /bin/false
install firewire-core /bin/false
install firewire-ohci /bin/false
install firewire-net /bin/false
install firewire-sbp2 /bin/false
install ohci1394 /bin/false
install raw1394 /bin/false
install sbp2 /bin/false
install video1394 /bin/false

# === GPS Modules (Location Privacy) ===
install garmin_gps /bin/false
install gnss /bin/false
install gnss-mtk /bin/false
install gnss-serial /bin/false
install gnss-sirf /bin/false
install gnss-ubx /bin/false
install gnss-usb /bin/false

# === Intel Platform Monitoring Technology (Disabling Telemetry) ===
install pmt_class /bin/false
install pmt_crashlog /bin/false
install pmt_telemetry /bin/false

# === Thunderbolt Modules (Preventing DMA Attacks) ===
install intel-wmi-thunderbolt /bin/false
install thunderbolt /bin/false
install thunderbolt_net /bin/false

# === Old and Rarely Used File Systems (Reducing Attack Surface) ===
# install cramfs /bin/false      # Commented out - may be needed for boot media
install freevxfs /bin/false
install hfs /bin/false
install hfsplus /bin/false
# install jffs2 /bin/false       # Commented out - may be needed for embedded systems
install jfs /bin/false
install reiserfs /bin/false
# install udf /bin/false         # Commented out - may be needed for DVD/CD boot

# === Network File Systems (Reducing Attack Surface) ===
install gfs2 /bin/false
install ksmbd /bin/false
install cifs /bin/false
install cifs_arc4 /bin/false
install cifs_md4 /bin/false
install nfs /bin/false
install nfs_acl /bin/false
install nfs_layout_nfsv41_files /bin/false
install nfs_layout_flexfiles /bin/false
install nfsd /bin/false
install nfsv2 /bin/false
install nfsv3 /bin/false
install nfsv4 /bin/false

# === Old and Rarely Used Network Protocols (Reducing Attack Surface) ===
install af_802154 /bin/false
install appletalk /bin/false
install ax25 /bin/false
install decnet /bin/false
install dccp /bin/false
install econet /bin/false
install eepro100 /bin/false
install eth1394 /bin/false
install ipx /bin/false
install n-hdlc /bin/false
install netrom /bin/false
install p8022 /bin/false
install p8023 /bin/false
install psnap /bin/false
install rose /bin/false
install x25 /bin/false

# === ATM Network Protocols (Reducing Attack Surface) ===
install atm /bin/false
install ueagle-atm /bin/false
install usbatm /bin/false
install xusbatm /bin/false

# === CAN Bus Protocols (Reducing Attack Surface) ===
install c_can /bin/false
install c_can_pci /bin/false
install c_can_platform /bin/false
install can /bin/false
install can-bcm /bin/false
install can-dev /bin/false
install can-gw /bin/false
install can-isotp /bin/false
install can-raw /bin/false
install can-j1939 /bin/false
install can327 /bin/false
install ifi_canfd /bin/false
install janz-ican3 /bin/false
install m_can /bin/false
install m_can_pci /bin/false
install m_can_platform /bin/false
install phy-can-transceiver /bin/false
install slcan /bin/false
install ucan /bin/false
install vxcan /bin/false
install vcan /bin/false

# === Other Network Protocols (Reducing Attack Surface) ===
install tipc /bin/false
install tipc_diag /bin/false
install rds /bin/false
install rds_rdma /bin/false
install rds_tcp /bin/false
install sctp /bin/false
install sctp_diag /bin/false

# === Other Modules (Reducing Attack Surface) ===
install hamradio /bin/false
install floppy /bin/false

# === Framebuffer Drivers (Reducing Attack Surface) ===
install aty128fb /bin/false
install atyfb /bin/false
install cirrusfb /bin/false
install cyber2000fb /bin/false
install cyblafb /bin/false
install gx1fb /bin/false
install hgafb /bin/false
install i810fb /bin/false
# install intelfb /bin/false     # Commented out - may be needed for Intel graphics boot
install kyrofb /bin/false
install lxfb /bin/false
install matroxfb_base /bin/false
install neofb /bin/false
# install nvidiafb /bin/false    # Commented out - may be needed for NVIDIA graphics boot
install pm2fb /bin/false
# install radeonfb /bin/false    # Commented out - may be needed for AMD graphics boot
install rivafb /bin/false
install s1d13xxxfb /bin/false
install savagefb /bin/false
install sisfb /bin/false
install sstfb /bin/false
install tdfxfb /bin/false
install tridentfb /bin/false
# install vesafb /bin/false      # Commented out - may be needed for VESA graphics boot
install vfb /bin/false
install viafb /bin/false
install vt8623fb /bin/false
install udlfb /bin/false
install asus_acpi /bin/false
install bcm43xx /bin/false
install de4x5 /bin/false
install prism54 /bin/false
